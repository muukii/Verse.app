default_platform(:ios)

platform :ios do
  lane :deploy do
    # ビルド・アーカイブ・エクスポートを実行
    build_ios_app(
      scheme: "YouTubeSubtitle",
      destination: "generic/platform=iOS",
      output_directory: "./build",           # IPA出力先を明示
      output_name: "YouTubeSubtitle.ipa",    # IPA名を明示
      archive_path: "./build/YouTubeSubtitle.xcarchive", # アーカイブパスを明示
      export_options: {
        method: "app-store",
        teamID: "KU2QEJ9K3Z",
        uploadSymbols: true,
      }
    )

    # TestFlightにアップロード
    upload_to_testflight(
      username: "muukii.app@gmail.com",
      ipa: "./build/YouTubeSubtitle.ipa"     # IPAパスを明示
    )
  end
end
